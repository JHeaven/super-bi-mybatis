package com.heaven.test;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;

import com.heaven.dao.impl.CellDaoImpl;
import com.heaven.model.Cell;
import com.heaven.utils.Get_Cell_Name;
import com.heaven.utils.Get_Cell_R_C;

/**
 * SJ-01税收资金平衡月报表$rpt$EJ3V89LSLEI61OZJU11T1LYKT5J5SN0K$EJ3V89LSLEI61OZJU11T1LYKT5J5SN0K.npf
SJ-02.npf
SJ-03应征税金明细月报表$rpt$5E0CERC4Y5N3YI2E8WWKUNANUSESQ7UF$5E0CERC4Y5N3YI2E8WWKUNANUSESQ7UF.npf
SJ-04待征税金变动情况月报表$rpt$30XQI48J53KC9D406UUR2YJKYO0OFTES$30XQI48J53KC9D406UUR2YJKYO0OFTES.npf
SJ-05提退税金明细月报表$rpt$Z6U19KUURZ4046T6LJJLPUW3626274SN$Z6U19KUURZ4046T6LJJLPUW3626274SN.npf
SJ-06减免税金明细月报表$rpt$REU0UTV99RJZ5ENESMMK0N7QAXEXQ1UF$REU0UTV99RJZ5ENESMMK0N7QAXEXQ1UF.npf
SJ-07多缴、待解、在途、待处理损失税金及损失税金核销明细月报表$rpt$KUUEXZOJLKXLYU9UIZZ4XJ3IV8U8Z2CM$KUUEXZOJLKXLYU9UIZZ4XJ3IV8U8Z2CM.npf
SJ-08查补税金及税款滞纳金、罚款收入明细月报表$rpt$YUYSPRB7SY8UPKKUPEEFJCM7MTUTTKXD$YUYSPRB7SY8UPKKUPEEFJCM7MTUTTKXD.npf
SJ-09滞纳金明细月报表$rpt$OQQLTLYNSOPIQM6QIUU3S17EUIQIEXD0$OQQLTLYNSOPIQM6QIUU3S17EUIQIEXD0.npf
SJ-10代征代扣税款明细月报表$rpt$TKQJ2KTMNTUMA08KO55IRUNMSUKU37SW$TKQJ2KTMNTUMA08KO55IRUNMSUKU37SW.npf
SJ-11税务代保管资金明细月报表$rpt$RKI0S6VL9R9ZAENKCMMI3U8U4XKX3PSW$RKI0S6VL9R9ZAENKCMMI3U8U4XKX3PSW.npf
SJ-12待清理呆帐税金明细月报表$rpt$I2LCU7TFJIKDEP329QQ7ENNCKB2BUIYP$I2LCU7TFJIKDEP329QQ7ENNCKB2BUIYP.npf
SJ-13改征增值税税收资金明细月报表$rpt$2NKW40Q6X2Q403UN5AAUUDUCAENE1T7I$2NKW40Q6X2Q403UN5AAUUDUCAENE1T7I.npf
SJ-14欠缴税金分风险类别月报表(2017)$rpt$JY0BFCK2L8B9YQAY4CLUR9L10NY7FCB8$JY0BFCK2L8B9YQAY4CLUR9L10NY7FCB8.npf
SJ-15_1税收收入分行业分税种统计月报总表（一）$rpt$8NB5CCIEC8ZY1M7NR22U2DCUVYNY1O7I$8NB5CCIEC8ZY1M7NR22U2DCUVYNY1O7I.npf
SJ-15_2税收收入分行业分税种统计月报总表（二）$rpt$YMM3W8DK8Y55FJXML44NZK1LUUMUMTZL$YMM3W8DK8Y55FJXML44NZK1LUUMUMTZL.npf
SJ-15_3税收收入分行业分税种统计月报总表（三）$rpt$C4CYNNJLDCE89TQ4YXXX1TOFAS4S9P5N$C4CYNNJLDCE89TQ4YXXX1TOFAS4S9P5N.npf
SJ-15_4税收收入分行业分税种统计月报总表（四）$rpt$T1UNS5ZN1T1PN9I1OCCZKUNVKU1UNT6Y$T1UNS5ZN1T1PN9I1OCCZKUNVKU1UNT6Y.npf
SJ-15_5税收收入分行业分税种统计月报总表（五）$rpt$L9K63UINKL1EQSR9700VWBN6CY9Y4TLA$L9K63UINKL1EQSR9700VWBN6CY9Y4TLA.npf
SJ-15_6税收收入分行业分税种统计月报总表（六）$rpt$FC3UIC4XUFXN6XMCSYYI6VSA39C9S4P6$FC3UIC4XUFXN6XMCSYYI6VSA39C9S4P6.npf
SJ-15_7税收收入分行业分税种统计月报总表（七）$rpt$2MXW9UQCX2I4Y3UM3AANJKSI7EMEMXZL$2MXW9UQCX2I4Y3UM3AANJKSI7EMEMXZL.npf
SJ-15_8税收收入分行业分税种统计月报总表（八）$rpt$3CMQDZ83539CND4CMUUF408LCOCO7WUZ$3CMQDZ83539CND4CMUUF408LCOCO7WUZ.npf
SJ-16税收收入分企业类型统计月报总表$rpt$YVYSDEBUSYZUNKKVCEEEXK8Q0TVTXPOU$YVYSDEBUSYZUNKKVCEEEXK8Q0TVTXPOU.npf
SJ-17_1增值税分行业分企业类型统计月报表（一）$rpt$SEXUNDA2MS9Y7ULEMLLKINA3JNENQ7UF$SEXUNDA2MS9Y7ULEMLLKINA3JNENQ7UF.npf
SJ-17_2增值税分行业分企业类型统计月报表（二）$rpt$ZYO1MTUIRZB0I6TYEJJCT9J3T2Y2IXTU$ZYO1MTUIRZB0I6TYEJJCT9J3T2Y2IXTU.npf
SJ-18消费税分税目分企业类型统计月报表$rpt$YIRSLTB4SYLUSKKIIEEM5EJLUTITY41L$YIRSLTB4SYLUSKKIIEEM5EJLUTITY41L.npf
SJ-19_1企业所得税分行业分企业类型统计月报表（一）$rpt$EC0V6RLWLEE6JOZCE11ICVQ0J5C5S7P6$EC0V6RLWLEE6JOZCE11ICVQ0J5C5S7P6.npf
SJ-19_2企业所得税分行业分企业类型统计月报表（二）$rpt$UN4N982EWUNF47BNZSSTUI3YWUNUAO9O$UN4N982EWUNF47BNZSSTUI3YWUNUAO9O.npf
SJ-20企业所得税分行业入库类型统计月报表$rpt$6POU8VKLE6UVAI0PTTT11OSE63P3KTUS$6POU8VKLE6UVAI0PTTT11OSE63P3KTUS.npf
SJ-21个人所得税分项目统计月报表$rpt$NKOMEK17PNDTOZCKAYYI1UNQCNKN37SW$NKOMEK17PNDTOZCKAYYI1UNQCNKN37SW.npf
SJ-22资源税分企业类型统计月报表$rpt$YU0SU3BVSYDUFKKUFEEF1CTI8TUTTOXD$YU0SU3BVSYDUFKKUFEEF1CTI8TUTTOXD.npf
SJ-23涉外税收税额统计月报表$rpt$8545ABIDC8JYQM75Z228DRUSFY5YLIM9$8545ABIDC8JYQM75Z228DRUSFY5YLIM9.npf
SJ-24税收欠税分行业分企业类型统计月报表$rpt$PINTMM0ITPRNERDID88SK4AFCFIFY7B2$PINTMM0ITPRNERDID88SK4AFCFIFY7B2.npf
SJ-25欠税分税种分属期统计月报表$rpt$TSIN19ZK1TLP49IS4CCBOCKX0USUJOF3$TSIN19ZK1TLP49IS4CCBOCKX0USUJOF3.npf
SJ-26待清理其他呆帐税金分项目统计月报表$rpt$UVQAZFUVNUUK54YVDSSEUK6RTZVZX1OU$UVQAZFUVNUUK54YVDSSEUK6RTZVZX1OU.npf
SJ-27减免税分行业统计年报表$rpt$U9LAXQUTNU9KI4Y9PSSVQBUQJZ9Z4LLA$U9LAXQUTNU9KI4Y9PSSVQBUQJZ9Z4LLA.npf
SJ-28减免税分企业类型统计年报表$rpt$9KSZBL6JU9MRQLPKTTTNA819Z7K7P42C$9KSZBL6JU9MRQLPKTTTNA819Z7K7P42C.npf
SJ-29减免税分减免类型统计年报表$rpt$4UNU1B7Z24VWJCKUSBB4TJ6ZC6U6Z1CM$4UNU1B7Z24VWJCKUSBB4TJ6ZC6U6Z1CM.npf
SJ-30县级税收收入分行业分税种统计年报表$rpt$KI6ESSOBLKVL9U9I5ZZMEENUM8I8YS1L$KI6ESSOBLKVL9U9I5ZZMEENUM8I8YS1L.npf
SJ-31县级税收收入分企业类型统计年报表$rpt$NULMTC1LPNBTEZCUUYY42JZCONUNZTCM$NULMTC1LPNBTEZCUUYY42JZCONUNZTCM.npf
SJ-32县级税收收入分级次分税种统计年报表$rpt$0WMTNU9UZ0310VMWUII2LM91N4W4RI3T$0WMTNU9UZ0310VMWUII2LM91N4W4RI3T.npf
SJ-33改征增值税分行业统计月报表$rpt$XR64K9CA7XU245NR1KKU3M45LLRLWNKB$XR64K9CA7XU245NR1KKU3M45LLRLWNKB.npf
SJ-34改征增值税分行业分企业类型统计月报表$rpt$MBNIVUPITMXJN1YBU33KU53USKBKTOWY$MBNIVUPITMXJN1YBU33KU53USKBKTOWY.npf
SJ-35改征增值税分税目分企业类型统计月报表$rpt$XIT4EYCD7X92O5NIUKKM5EM9CLILYK1L$XIT4EYCD7X92O5NIUKKM5EM9CLILYK1L.npf
SJ-36税收收入分企业规模分税种统计月报表$rpt$I3NCQ3TKJICDFP33KQQYOZ6KXB3BKPJR$I3NCQ3TKJICDFP33KQQYOZ6KXB3BKPJR.npf
SJ-37税收收入分企业规模分行业统计月报表$rpt$TKIJ8ZT5NTIM808KU55KL8UTVUKU1L3C$TKIJ8ZT5NTIM808KU55KL8UTVUKU1L3C.npf
SJ-38税收收入分企业规模分注册类型统计月报表$rpt$LFMLXCSIIL0K7YUFBRRNUIT7ECFCRL8J$LFMLXCSIIL0K7YUFBRRNUIT7ECFCRL8J.npf
SJ-39增值税主要行业税源统计月报表$rpt$SENIRCSOUSDOABEEIVVKMNORCJEJQPUF$SENIRCSOUSDOABEEIVVKMNORCJEJQPUF.npf
SJ-40改征增值税主要品目税源统计月报表$rpt$NTUK9UWOFNKUA2STKUUP2LJWLRTRBTRI$NTUK9UWOFNKUA2STKUUP2LJWLRTRBTRI.npf

 * @author jiangyqc
 *
 */
public class GoWithStrings {
	public static void main(String[] args) {

		CellDaoImpl cellDao = new CellDaoImpl();
		File file = null;
		
		String [] files = {
				"SJ-36税收收入分企业规模分税种统计月报表$rpt$I3NCQ3TKJICDFP33KQQYOZ6KXB3BKPJR$I3NCQ3TKJICDFP33KQQYOZ6KXB3BKPJR.npf",
				"SJ-37税收收入分企业规模分行业统计月报表$rpt$TKIJ8ZT5NTIM808KU55KL8UTVUKU1L3C$TKIJ8ZT5NTIM808KU55KL8UTVUKU1L3C.npf",
				"SJ-38税收收入分企业规模分注册类型统计月报表$rpt$LFMLXCSIIL0K7YUFBRRNUIT7ECFCRL8J$LFMLXCSIIL0K7YUFBRRNUIT7ECFCRL8J.npf",
				"SJ-39增值税主要行业税源统计月报表$rpt$SENIRCSOUSDOABEEIVVKMNORCJEJQPUF$SENIRCSOUSDOABEEIVVKMNORCJEJQPUF.npf",
				"SJ-40改征增值税主要品目税源统计月报表$rpt$NTUK9UWOFNKUA2STKUUP2LJWLRTRBTRI$NTUK9UWOFNKUA2STKUUP2LJWLRTRBTRI.npf"
};
		for (int i = 0; i < files.length; i++) {
			
				file = new File("D:/2017年会统报表/"+files[i]);
				
				String text = txt2String(file);
				
				String text_r_c = text.substring(text.indexOf("<cl r=0 c=0"),text.lastIndexOf("</cl>")+5).replace("\\u20", "");
				
				Cell cellTop = new Cell();
				cellTop.setReportAlias(Get_Cell_Name.getAlias(text));
				cellTop.setReportCaption(Get_Cell_Name.getCaption(text));
				cellTop.setReportId(Get_Cell_Name.getID(text));
				cellTop.setReportName(Get_Cell_Name.getName(text));
				cellTop.setReportTaskid(Get_Cell_Name.getTaskId(text));
				cellTop.setReportType(Get_Cell_Name.getType(text));
				
				//提取数据格串
				Get_Cell_R_C.getRC(text_r_c, cellDao,cellTop);
				
				
			
		}
		
		
		
		
	}

	/**
	 * 读取文本文件的内容
	 * @param file 想要读取的文件对象
	 * @return 返回文件内容
	 */
	public static String txt2String(File file) {
		StringBuilder result = new StringBuilder();
		try {
			BufferedReader br = new BufferedReader(new FileReader(file));
			String s = null;
			while ((s = br.readLine()) != null) {
				result.append(System.lineSeparator() + s);
			}
			br.close();
		} catch (Exception e) {
			System.err.println("file not found!");
			System.exit(0);
//			/e.printStackTrace();
		}
		return result.toString();
	}
}
